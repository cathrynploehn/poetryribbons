var SCALE=8,index=1;!function(i){i.fn.minimap=function(){function s(){n=i("#mini-map"),n.append('<div id="current-view">'),els=i("#originalLyrics-pane").children(),els.each(function(s,a){var e=i(this).offset(),r=i(this).height()/SCALE,o=parseInt(i(this).css("margin-top"))/SCALE,c=parseInt(i(this).css("margin-bottom"))/SCALE;p=0==s?e.top/SCALE-o:e.top/SCALE+t,t=o+c;var l=i("<div>");l.css({height:r+"px","margin-top":o+"px","margin-bottom":c+"px",top:p+"px"}).addClass(a.tagName.toLowerCase()),0==s||s>=i(els).size()-1?l.addClass("lyrics-pane-padding"):i(this).hasClass("space")?l.addClass("space"):(l.addClass("line"+index),index++),l.appendTo(n)}),a()}function a(){var s=0;i.each(n.find("div"),function(){s+=parseInt(i(this).outerHeight(!0))}),s+=20;var a=r.offset();i("#mini-map-container").css({height:s+"px",right:"10px",top:a.top+"px"}),e=i("#current-view");{var t=i(".poem-lyrics-pane-lyrics").height()/(SCALE-1);i(".poem-lyrics-pane-lyrics").width()/SCALE}e.css({height:t+"px"}).draggable({axis:"y",containment:"#mini-map",drag:function(){var s=i(e).position(),a=s.top*SCALE;i(".poem-lyrics-pane-lyrics").scrollTop(a)}})}{var n,e,t,p,r=i("#originalLyrics-pane");r.offset()}i(".poem-lyrics-pane-lyrics").scroll(function(){var s=i(".poem-lyrics-pane-lyrics").scrollTop()/SCALE;e.css({top:s+"px"})}),s()}}(jQuery);